<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/mesa2022_hmxb/libs/katex/katex.min.css"> <link rel=stylesheet  href="/mesa2022_hmxb/libs/highlight/github.min.css"> <link rel=stylesheet  href="/mesa2022_hmxb/css/franklin.css"> <link rel=stylesheet  href="/mesa2022_hmxb/css/poole_hyde.css"> <link rel=stylesheet  href="/mesa2022_hmxb/css/extras.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/mesa2022_hmxb/assets/favicon.png"> <title>Minilab 2: Future evolution of HMXBs</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h2><a href="/mesa2022_hmxb/">Mass transfer in HMXBs with MESA</a></h2> <img src="/mesa2022_hmxb/assets/PobreEstrella.png"/> <p class=lead ></p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/mesa2022_hmxb/">Home</a> <a class="sidebar-nav-item " href="/mesa2022_hmxb/minilab1/"><span style="color:brown">Minilab 1:</span> Mass transfer prescriptions in MESA</a> <a class="sidebar-nav-item active" href="/mesa2022_hmxb/minilab2/"><span style="color:brown">Minilab 2:</span> Future evolution of HMXBs</a> <a class="sidebar-nav-item " href="/mesa2022_hmxb/maxilab/"><span style="color:brown">Maxilab</span>: Formation of GW sources through RLOF</a> </nav> <p>&copy; Pablo Marchant.</p> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=minilab_2_future_evolution_of_hmxbs ><a href="#minilab_2_future_evolution_of_hmxbs" class=header-anchor >Minilab 2: Future evolution of HMXBs</a></h1> <div class=franklin-toc ><ol><li><a href="#high_mass_x-ray_binaries_with_black_holes">High mass X-ray binaries with black holes</a><li><a href="#modifications_to_the_template">Modifications to the template</a><li><a href="#run_your_models">Run your models</a><li><a href="#limitations_of_mesa">Limitations of MESA</a><li><a href="#angular_momentum_losses">Angular momentum losses</a><ol><li><a href="#copy_the_null_routine_for_the_hook">Copy the null routine for the hook</a><li><a href="#locate_and_modify_the_original_code">Locate and modify the original code</a></ol><li><a href="#extra_work">Extra work</a><li><a href="#answers">Answers</a><li><a href="#references">References</a></ol></div> <h2 id=high_mass_x-ray_binaries_with_black_holes ><a href="#high_mass_x-ray_binaries_with_black_holes" class=header-anchor >High mass X-ray binaries with black holes</a></h2> <p>The objective of this lab will be to study the future evolution of X-ray binaries known to have black holes, for which we also have a well characterised orbital solution. The following table shows the properties of these systems that will be relevant to our models:</p> <table><tr><th align=right >Name<th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi mathvariant=normal >s</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">M_\mathrm{star}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">star</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><msub><mi>M</mi><mo>⊙</mo></msub><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[M_\odot]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">⊙</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mclose >]</span></span></span></span><th align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi mathvariant=normal >B</mi><mi mathvariant=normal >H</mi></mrow></msub></mrow><annotation encoding="application/x-tex">M_\mathrm{BH}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">BH</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><msub><mi>M</mi><mo>⊙</mo></msub><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[M_\odot]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.2583em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">⊙</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2083em;"><span></span></span></span></span></span></span><span class=mclose >]</span></span></span></span><th align=right >Period <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >[</mo><mi>d</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">[d]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class="mord mathnormal">d</span><span class=mclose >]</span></span></span></span><th align=right >Reference<tr><td align=right >Cyg X-1<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>40.</mn><msubsup><mn>6</mn><mrow><mo>−</mo><mn>7.1</mn></mrow><mrow><mo>+</mo><mn>7.7</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">40.6^{+7.7}_{-7.1}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1789em;vertical-align:-0.3246em;"></span><span class=mord >40.</span><span class=mord ><span class=mord >6</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8542em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">7.1</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">7.7</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3246em;"><span></span></span></span></span></span></span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>21.</mn><msubsup><mn>2</mn><mrow><mo>−</mo><mn>2.3</mn></mrow><mrow><mo>+</mo><mn>2.2</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">21.2^{+2.2}_{-2.3}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.1789em;vertical-align:-0.3246em;"></span><span class=mord >21.</span><span class=mord ><span class=mord >2</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8542em;"><span style="top:-2.4337em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2.3</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">+</span><span class="mord mtight">2.2</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3246em;"><span></span></span></span></span></span></span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5.60</mn></mrow><annotation encoding="application/x-tex">5.60</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >5.60</span></span></span></span><td align=right ><span class=bibref ><a href="#miller-jones21">Miller-Jones et al. (2021)</a></span><tr><td align=right >LMC X-1<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>31.79</mn><mo>±</mo><mn>3.67</mn></mrow><annotation encoding="application/x-tex">31.79\pm3.67</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7278em;vertical-align:-0.0833em;"></span><span class=mord >31.79</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >±</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >3.67</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10.9</mn><mo>±</mo><mn>1.4</mn></mrow><annotation encoding="application/x-tex">10.9\pm1.4</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7278em;vertical-align:-0.0833em;"></span><span class=mord >10.9</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >±</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1.4</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3.91</mn></mrow><annotation encoding="application/x-tex">3.91</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >3.91</span></span></span></span><td align=right ><span class=bibref ><a href="#orosz09">Orosz et al. (2009)</a></span><tr><td align=right >M33 X-7<td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>70.0</mn><mo>±</mo><mn>6.9</mn></mrow><annotation encoding="application/x-tex">70.0\pm6.9</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7278em;vertical-align:-0.0833em;"></span><span class=mord >70.0</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >±</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >6.9</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15.65</mn><mo>±</mo><mn>1.45</mn></mrow><annotation encoding="application/x-tex">15.65\pm1.45</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.7278em;vertical-align:-0.0833em;"></span><span class=mord >15.65</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >±</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >1.45</span></span></span></span><td align=right ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3.45</mn></mrow><annotation encoding="application/x-tex">3.45</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >3.45</span></span></span></span><td align=right ><span class=bibref ><a href="#orosz07">Orosz et al. (2007)</a></span></table> <figure style="text-align:center;"><figcaption> HMXBs with orbital solutions that are known to host black holes.</figcaption> </figure> <p>All of these systems are expected to have started as a non-degenerate binary, where the progenitor of the black hole transferred mass to the star that is currently observed in the system. This potentially means that the star that is observed digresses from the evolution of a single star, and if we wanted to be fully consistent we would need to model the evolution of the system starting from two stars at the zero age main sequence. Here we will avoid this complication by approximating the star as a zero age main sequence star of the present-day mass, and we will also ignore the errors in the observations. So, for example, to model Cyg X-1 we will use the following in our <code>inlist_project</code>:</p> <pre><code class="fortran hljs">m1 = <span class=hljs-number >40.6d0</span>
m2 = <span class=hljs-number >21.2d0</span>
initial_period_in_days = <span class=hljs-number >5.6d0</span></code></pre> <p>Here <code>m1</code> corresponds to the mass of the star and <code>m2</code> to the mass of the black hole, which me model as a point mass. The objective will be to model the three systems in the table above, study how binary interaction differs between them, and assess some of the limitations of the <code>binary</code> module.</p> <h2 id=modifications_to_the_template ><a href="#modifications_to_the_template" class=header-anchor >Modifications to the template</a></h2> <p>We will start this minilab using the solution to minilab 1. <span style="color:red"> Throughout the lab we will make use of</span> <code>mdot_scheme&#61;&#39;Kolb&#39;</code>. Two small adjustements that we will need are the following</p> <ul> <li><p>Set <code>max_model_number&#61;400</code> in <code>inlist1</code>. This is enough to model the systems until near-detachment. We will ignore the core helium burning phase.</p> <li><p>Add <code>Kipp_xaxis_name &#61; &#39;star_age&#39;</code> and change <code>History_Panels1_xaxis_name&#61;&#39;star_age&#39;</code> in <code>inlist1</code>. Having properties shown against time instead of model number in <code>pgstar</code> will help understand the different timescales that come into play.</p> </ul> <div class=colbox-blue >Did you have issues finishing minilab1? You can get a working copy of its solution <a href="/mesa2022_hmxb/assets/minilab2/template2.tar.gz">here</a>.</div> <h2 id=run_your_models ><a href="#run_your_models" class=header-anchor >Run your models</a></h2> <p>Now, using the adjusted template, run all three simulations. Answer the following questions, and discuss them with those on your table. You can also spread out the work among your nearby colleagues, if so be sure to have two people modelling M33 X-7:</p> <ul> <li><p>How much does the mass transfer phase last compared to the total lifetime of the system &#40;consider here only the time modeled within the <code>max_model_number&#61;400</code> constraint&#41;.</p> <li><p>Do the evolution of these systems differ qualitatively from the one on minilab1?</p> <li><p>Are all simulations running smoothly? Or are you running into numerical issues?</p> </ul> <p>The last point in particular will be dealt with in the next section, so if you find everything is running smoothly be sure to double check&#33;</p> <h2 id=limitations_of_mesa ><a href="#limitations_of_mesa" class=header-anchor >Limitations of MESA</a></h2> <p>As you might have seen, one of the systems modeled runs into some issues &#40;to put it lightly&#41;. Mass transfer rates go to very high values, approaching a solar mass per year. This points to some limitations within MESA, as the code models the donor star as a 1-dimensional object. For extreme mass ratios, the shrinkage of the orbit as mass transfer proceeds becomes extreme enough that the star cannot adjust itself through mass loss to avoid extreme overflow. In such a case the donor would very likely engulf its companion, initiating a process of common-envelope evolution which is fundamentally 3-dimensional. MESA being a 1-dimensional code cannot deal with such a situation, but rather tries to keep modeling this evolutionary phase as a stable mass transfer event with an ever increasing mass transfer rate, which eventually leads to numerical problems.</p> <p>Although there are ways to approximate a common-envelope phase with MESA, here we wish to simply construct a physical criteria to identify when an unstable mass transfer phase could start, and terminate the evolution at that stage. For this purpose we will consider the thermal and dynamical timescales of the star:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>τ</mi><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>G</mi><msup><mi>M</mi><mn>2</mn></msup></mrow><mrow><mi>R</mi><mi>L</mi></mrow></mfrac><mo separator=true >,</mo><mspace width=1em /><msub><mi>τ</mi><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >y</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><mi>G</mi><mo stretchy=false >⟨</mo><mi>ρ</mi><mo stretchy=false >⟩</mo></mrow></msqrt></mfrac></mrow><annotation encoding="application/x-tex">\tau_\mathrm{thermal}=\frac{GM^2}{RL},\quad \tau_\mathrm{dynamical}=\frac{1}{\sqrt{G\langle \rho\rangle}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5806em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">thermal</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.1771em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.4911em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">L</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">G</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">dynamical</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.4514em;vertical-align:-1.13em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.175em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.935em;"><span class=svg-align  style="top:-3.2em;"><span class=pstrut  style="height:3.2em;"></span><span class=mord  style="padding-left:1em;"><span class="mord mathnormal">G</span><span class=mopen >⟨</span><span class="mord mathnormal">ρ</span><span class=mclose >⟩</span></span></span><span style="top:-2.895em;"><span class=pstrut  style="height:3.2em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119 c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120 c340,-704.7,510.7,-1060.3,512,-1067 l0 -0 c4.7,-7.3,11,-11,19,-11 H40000v40H1012.3 s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232 c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1 s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26 c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.305em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:1.13em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>.</p> <p>From these one can define characteristic mass transfer rates:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mfrac><mi>M</mi><msub><mi>τ</mi><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mfrac><mspace width=1em /><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >y</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub><mo>=</mo><mfrac><mi>M</mi><msub><mi>τ</mi><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >y</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">\dot{M}_\mathrm{thermal}=\frac{M}{\tau_\mathrm{thermal}}\quad \dot{M}_\mathrm{dynamical}=\frac{M}{\tau_\mathrm{dynamical}}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0702em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">thermal</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.1963em;vertical-align:-0.836em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">thermal</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.836em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:1em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">dynamical</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.3324em;vertical-align:-0.9721em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3603em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">dynamical</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9721em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <p>As a criteria to test for unstable mass transfer we will check at the end of each timestep if the mass transfer <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >s</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\dot{M}_\mathrm{transfer}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0702em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">transfer</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> exceeds significantly the thermal rate. This is indicative of the donor approaching a near-adiabatic behavior, leading to runaway overflow. In particular, we will require that <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >s</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi></mrow></msub><mo>&gt;</mo><mn>100</mn><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\dot{M}_\mathrm{transfer}&gt;100 \dot{M}_\mathrm{thermal}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0702em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">transfer</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.0702em;vertical-align:-0.15em;"></span><span class=mord >100</span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">thermal</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to terminate the simulation.</p> <p>Implement this check in <code>extras_binary_finish_step</code>. Use the following pointers to do so:</p> <ul> <li><p>You can use the defined constant <code>standard_cgrav</code>. Compute both <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >t</mi><mi mathvariant=normal >h</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >r</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\dot{M}_\mathrm{thermal}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.0702em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">thermal</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent=true ><mi>M</mi><mo>˙</mo></mover><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >y</mi><mi mathvariant=normal >n</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >c</mi><mi mathvariant=normal >a</mi><mi mathvariant=normal >l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\dot{M}_\mathrm{dynamical}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2063em;vertical-align:-0.2861em;"></span><span class=mord ><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.9202em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span><span style="top:-3.2523em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.0556em;"><span class=mord >˙</span></span></span></span></span></span></span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">dynamical</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> and print their values out, to turn them from cgs units to solar masses per year, you can use the constants <code>Msun</code> and <code>secyer</code>.</p> <li><p>The mass transfer rate is contained in <code>b&#37; mtransfer_rate</code>. <span style="color:red"> Bear in mind that it is defined as negative.</span></p> <li><p>Setting <code>extras_binary_finish_step &#61; terminate</code> within the subroutine will terminate your simulation.</p> <li><p>Whenever you terminate a simulation in this way, it is ideal to print a message so the run does not just silently stop.</p> </ul> <button type=button  class=collapsible > Implementation, <strong>press to expand <span style="color:red"> (Spoilers!!)</span></strong> </button><div class=collapsiblecontent > </p> <pre><code class="fortran hljs"><span class=hljs-keyword >integer</span> <span class=hljs-function ><span class=hljs-keyword >function</span></span> extras_binary_finish_step(binary_id)
   <span class=hljs-keyword >type</span> (binary_info), <span class=hljs-keyword >pointer</span> :: b
   <span class=hljs-keyword >integer</span>, <span class=hljs-keyword >intent</span>(<span class=hljs-keyword >in</span>) :: binary_id
   <span class=hljs-keyword >integer</span> :: ierr
   <span class=hljs-keyword >real</span>(dp) :: mdot_th, mdot_dyn, avg_rho
   <span class=hljs-keyword >call</span> binary_ptr(binary_id, b, ierr)
   <span class=hljs-keyword >if</span> (ierr /= <span class=hljs-number >0</span>) <span class=hljs-keyword >then</span> <span class=hljs-comment >! failure in  binary_ptr</span>
      <span class=hljs-keyword >return</span>
   <span class=hljs-keyword >end</span> <span class=hljs-keyword >if</span>  
   extras_binary_finish_step = keep_going

   mdot_th = b% m(<span class=hljs-number >1</span>)/(standard_cgrav*(b% m(<span class=hljs-number >1</span>))**<span class=hljs-number >2</span>/(b% s1% L(<span class=hljs-number >1</span>)*b% r(<span class=hljs-number >1</span>)))

   avg_rho = b% m(<span class=hljs-number >1</span>)/(<span class=hljs-number >4d0</span>/<span class=hljs-number >3d0</span>*(b% r(<span class=hljs-number >1</span>))**<span class=hljs-number >3</span>)
   mdot_dyn = b% m(<span class=hljs-number >1</span>)/(<span class=hljs-number >1</span>/<span class=hljs-built_in >sqrt</span>(standard_cgrav*avg_rho))

   <span class=hljs-built_in >write</span>(*,*) <span class=hljs-string >&quot;check mdots&quot;</span>, mdot_th/Msun*secyer, mdot_dyn/Msun*secyer
   <span class=hljs-keyword >if</span> (<span class=hljs-built_in >abs</span>(b% mtransfer_rate)&gt;<span class=hljs-number >100d0</span>*mdot_th) <span class=hljs-keyword >then</span>
       <span class=hljs-built_in >write</span>(*,*) <span class=hljs-string >&quot;Finish simulation due to high mass transfer rate&quot;</span>
       extras_binary_finish_step = terminate
   <span class=hljs-keyword >end</span> <span class=hljs-keyword >if</span>

   
<span class=hljs-keyword >end</span> <span class=hljs-function ><span class=hljs-keyword >function</span></span> extras_binary_finish_step</code></pre> <p></div> <p>After making these changes re-run the model that had issues, and see if it triggers the condition. Also, see how the thermal timescale compares to the dynamical one.</p> <p>Having physical termination conditions to capture regions where MESA cannot properly model an evolutionary phase can be very valuable. It helps avoid the production of spurious results, and also avoids simulations from getting stuck into situations where timesteps become extremely small and simulations could in principle run for years without completing. This can be a big issue when running a large number of simulations in a cluster, potentially leading to a significant waste of resources. <span style="color:red"> Ensuring we don't have pointless simulations running helps our carbon-footprint so we feel less guilty about travelling so much!</span></p> <h2 id=angular_momentum_losses ><a href="#angular_momentum_losses" class=header-anchor >Angular momentum losses</a></h2> <p>In the simulations we have done so far mass transfer is highly non-conservative. To model orbital evolution, it is assumed that the material that is removed carries the same specific orbital angular momentum as the compact object. However, during the mass transfer process material can be potentially ejected from the outer Lagrangian points instead, as illustrated in the following figure:</p> <figure style="text-align:center;"> <img src="/mesa2022_hmxb/assets/wenbin.png" style="padding:0; width:100%;border: 1px solid gray;" alt=" Ejection of material from the accretion disk towards the second Lagrangian point. Image from \cite{Lu+22}, CBO stands for circumbinary outflow."/> <figcaption> Ejection of material from the accretion disk towards the second Lagrangian point. Image from <span class=bibref ><a href="#lu22">Lu et al. (2022)</a></span>, CBO stands for circumbinary outflow.</figcaption> </figure> <p>We will not study here the different physical processes that can lead to such outflows, but just consider how they could impact orbital evolution. As the outer Lagrangian points are farther away from the center of mass of the system than the accreting star, the orbital angular momentum of material that co-rotates with them is higher. Material that is ejected through the outer Lagrangian points is then expected to increase the loss of orbital angular momentum, leading to smaller orbital separations as mass transfer proceeds.</p> <p>For simplicity, <span style="color:red"> we will assume a simple boost of a factor of 3</span> compared to the standard amount of angular momentum lost due to mass loss. This will be done using an <code>other</code> hook in <code>run_binary_extras</code>. Here we will go step-by-step on how one would implement this, also dealing with how the original implementation that we want to modify can be localized within the MESA source code.</p> <h3 id=copy_the_null_routine_for_the_hook ><a href="#copy_the_null_routine_for_the_hook" class=header-anchor >Copy the null routine for the hook</a></h3> <p>The hook we will use is <code>other_jdot_ml</code>. Start by including <code>use_other_jdot_ml &#61; .true.</code> in the <code>binary_controls</code> section of your <code>inlist_project</code>. If you just do this, the code will use a <code>null</code> subroutine to compute the angular momentum loss, which just sets it to zero. This is a placeholder that you need to replace with the subroutine you want to use. For this, do the following:</p> <ul> <li><p>Look up in the files in <code>&#36;MESA_DIR/binary/other</code> for the place where this null subroutine is defined, and copy it to your <code>run_binary_extras</code>.</p> <li><p>Give the copied subroutine a name of your liking.</p> <li><p>Make <code>MESA</code> aware of this subroutine in your <code>run_binary_extras</code> by pointing to it in <code>extras_binary_controls</code> &#40;the following assumes you named this subroutine <code>my_jdot_ml</code>&#41;:</p> </ul> <pre><code class="fortran hljs">b% other_jdot_ml =&gt; my_jdot_ml</code></pre>
<p>After doing this compile your work directory to verify there are no issues up to this stage.</p>
<h3 id=locate_and_modify_the_original_code ><a href="#locate_and_modify_the_original_code" class=header-anchor >Locate and modify the original code</a></h3>
<p>Now we want to locate the place within MESA where the angular momentum loss is computed, and modify it accordingly in our hook. Start in a terminal by going to the folder where the <code>binary</code> module is located, and use the <code>grep</code> command to find where the code we are looking for is. We can focus on the <code>&#36;MESA_DIR/binary/private</code> folder which contains the relevant files of the binary module, and look for <code>jdot_ml</code>.</p>
<pre><code class="bash hljs"><span class=hljs-built_in >cd</span> <span class=hljs-variable >$MESA_DIR</span>/binary
grep -n -r <span class=hljs-string >&quot;jdot_ml&quot;</span> private/*</code></pre>
<p>The <code>-n</code> argument for <code>grep</code> will provide the line number. The <code>-r</code> command will recursively look into folders, it is not necessary in this particular case, but it is useful when trying to locate things in a wider range of locations. The outcome of this command  should look like the following:</p>
<pre><code class="bash hljs">private/binary_ce.f90:262:         b% jdot_ml = 0d0
private/binary_ctrls_io.f90:145:         do_jdot_ml, &amp;
private/binary_ctrls_io.f90:223:         use_other_jdot_ml, &amp;
private/binary_ctrls_io.f90:495:         b% do_jdot_ml = do_jdot_ml
private/binary_ctrls_io.f90:573:         b% use_other_jdot_ml = use_other_jdot_ml
private/binary_ctrls_io.f90:685:         do_jdot_ml = b% do_jdot_ml
private/binary_ctrls_io.f90:759:         use_other_jdot_ml = b% use_other_jdot_ml
private/binary_do_one_utils.f90:368:            b% jdot_ml, &amp;
private/binary_evolve.f90:378:            write(*,*) <span class=hljs-string >&quot;jdot, jdot_mb, jdot_gr, jdot_ml:&quot;</span>, b% jdot, b% jdot_mb, b% jdot_gr, b% jdot_ml
private/binary_history.f90:609:            <span class=hljs-keyword >case</span>(bh_jdot_ml)
private/binary_history.f90:610:               val = b% jdot_ml
private/binary_jdot.f90:54:         <span class=hljs-keyword >if</span> (.not. b% do_jdot_ml) <span class=hljs-keyword >then</span>
private/binary_jdot.f90:55:             b% jdot_ml = 0d0
private/binary_jdot.f90:56:         <span class=hljs-keyword >else</span> <span class=hljs-keyword >if</span> (.not. b% use_other_jdot_ml) <span class=hljs-keyword >then</span>
private/binary_jdot.f90:57:             call default_jdot_ml(b% binary_id, ierr)
private/binary_jdot.f90:59:             call b% other_jdot_ml(b% binary_id, ierr)
private/binary_jdot.f90:96:         get_jdot = (b% jdot_mb + b% jdot_gr + b% jdot_ml + b% jdot_missing_wind + &amp;
private/binary_jdot.f90:119:      subroutine default_jdot_ml(binary_id, ierr)
private/binary_jdot.f90:131:         b% jdot_ml = (b% mdot_system_transfer(b% d_i) + b% mdot_system_wind(b% d_i))*&amp;
private/binary_jdot.f90:135:         b% jdot_ml = b% jdot_ml + (b% mdot_system_transfer(b% a_i) + b% mdot_system_wind(b% a_i))*&amp;
private/binary_jdot.f90:139:         b% jdot_ml = b% jdot_ml + b% mdot_system_cct * b% mass_transfer_gamma * &amp;
private/binary_jdot.f90:141:      end subroutine default_jdot_ml
private/binary_private_def.f90:86:      <span class=hljs-built_in >integer</span>, parameter :: bh_jdot_ml = bh_jdot_gr + 1
private/binary_private_def.f90:87:      <span class=hljs-built_in >integer</span>, parameter :: bh_jdot_ls = bh_jdot_ml + 1
private/binary_private_def.f90:174:         binary_history_column_name(bh_jdot_ml) = <span class=hljs-string >&#x27;jdot_ml&#x27;</span>
private/run_binary_support.f90:180:         b% other_jdot_ml =&gt; null_other_jdot_ml</code></pre>
<p>Using this information, locate the relevant subroutine and copy its contents into the  custom subroutine in your <code>run_binary_extras</code>.  <span style="color:red"> Lookup the contribution from mass
loss near the vicinity of the accretor and include a factor of 3 boost to it</span>. Then compile your work directory before running a simulation.</p>
<div class=colbox-blue >I&#39;ve had a non-negligible number of ocassions were I setup a hook but forget some important detail in the process like including <code>use_other_jdot_ml</code> in my inlists. I would recommend at first printing out a simple message from your hook subroutine to double-check that it is actually being used&#33;</div>
<h3>Rerun a case that was stable</h3>
<p>With everything ready, go ahead and rerun one of the binary systems that underwent stable mass  transfer. How does the evolution differ with the shift in angular momentum loss? If you have trouble implementing  this hook, below you can find the implementation for it.</p>
<button type=button  class=collapsible >  Implementation, <strong>press to expand  <span style="color:red"> (Spoilers!!)</span></strong> </button><div class=collapsiblecontent >  </p>
<pre><code class="fortran hljs"><span class=hljs-function ><span class=hljs-keyword >subroutine</span></span> extras_binary_controls(binary_id, ierr)
   <span class=hljs-keyword >integer</span> :: binary_id
   <span class=hljs-keyword >integer</span>, <span class=hljs-keyword >intent</span>(<span class=hljs-keyword >out</span>) :: ierr
   <span class=hljs-keyword >type</span> (binary_info), <span class=hljs-keyword >pointer</span> :: b
   ierr = <span class=hljs-number >0</span> 

   <span class=hljs-keyword >call</span> binary_ptr(binary_id, b, ierr)
   <span class=hljs-keyword >if</span> (ierr /= <span class=hljs-number >0</span>) <span class=hljs-keyword >then</span>
      <span class=hljs-built_in >write</span>(*,*) <span class=hljs-string >&#x27;failed in binary_ptr&#x27;</span>
      <span class=hljs-keyword >return</span>
   <span class=hljs-keyword >end</span> <span class=hljs-keyword >if</span>

   <span class=hljs-comment >! Set these function pointers to point to the functions you wish to use in</span>
   <span class=hljs-comment >! your run_binary_extras. Any which are not set, default to a null_ version</span>
   <span class=hljs-comment >! which does nothing.</span>
   b% how_many_extra_binary_history_header_items =&gt; how_many_extra_binary_history_header_items
   b% data_for_extra_binary_history_header_items =&gt; data_for_extra_binary_history_header_items
   b% how_many_extra_binary_history_columns =&gt; how_many_extra_binary_history_columns
   b% data_for_extra_binary_history_columns =&gt; data_for_extra_binary_history_columns

   b% extras_binary_startup=&gt; extras_binary_startup
   b% extras_binary_start_step=&gt; extras_binary_start_step
   b% extras_binary_check_model=&gt; extras_binary_check_model
   b% extras_binary_finish_step =&gt; extras_binary_finish_step
   b% extras_binary_after_evolve=&gt; extras_binary_after_evolve

   b% other_jdot_ml =&gt; my_jdot_ml

   <span class=hljs-comment >! Once you have set the function pointers you want, then uncomment this (or set it in your star_job inlist)</span>
   <span class=hljs-comment >! to disable the printed warning message,</span>
    b% warn_binary_extra =.false.
   
<span class=hljs-keyword >end</span> <span class=hljs-function ><span class=hljs-keyword >subroutine</span></span> extras_binary_controls

<span class=hljs-function ><span class=hljs-keyword >subroutine</span></span> my_jdot_ml(binary_id, ierr)
   <span class=hljs-keyword >integer</span>, <span class=hljs-keyword >intent</span>(<span class=hljs-keyword >in</span>) :: binary_id
   <span class=hljs-keyword >integer</span>, <span class=hljs-keyword >intent</span>(<span class=hljs-keyword >out</span>) :: ierr
   <span class=hljs-keyword >type</span> (binary_info), <span class=hljs-keyword >pointer</span> :: b
   ierr = <span class=hljs-number >0</span> 
   <span class=hljs-keyword >call</span> binary_ptr(binary_id, b, ierr)
   <span class=hljs-keyword >if</span> (ierr /= <span class=hljs-number >0</span>) <span class=hljs-keyword >then</span>
      <span class=hljs-built_in >write</span>(*,*) <span class=hljs-string >&#x27;failed in binary_ptr&#x27;</span>
      <span class=hljs-keyword >return</span>
   <span class=hljs-keyword >end</span> <span class=hljs-keyword >if</span>
   <span class=hljs-comment >!mass lost from vicinity of donor</span>
   b% jdot_ml = (b% mdot_system_transfer(b% d_i) + b% mdot_system_wind(b% d_i))*&amp;
       pow2(b% m(b% a_i)/(b% m(b% a_i)+b% m(b% d_i))*b% separation)*<span class=hljs-number >2</span>*pi/b% period *&amp;
       <span class=hljs-built_in >sqrt</span>(<span class=hljs-number >1</span> - pow2(b% eccentricity))
   <span class=hljs-comment >!mass lost from vicinity of accretor</span>
   b% jdot_ml = b% jdot_ml + <span class=hljs-number >3d0</span>*(b% mdot_system_transfer(b% a_i) + b% mdot_system_wind(b% a_i))*&amp;
       pow2(b% m(b% d_i)/(b% m(b% a_i)+b% m(b% d_i))*b% separation)*<span class=hljs-number >2</span>*pi/b% period *&amp;
       <span class=hljs-built_in >sqrt</span>(<span class=hljs-number >1</span> - pow2(b% eccentricity))
   <span class=hljs-comment >!mass lost from circumbinary coplanar toroid</span>
   b% jdot_ml = b% jdot_ml + b% mdot_system_cct * b% mass_transfer_gamma * &amp; 
       <span class=hljs-built_in >sqrt</span>(standard_cgrav * (b% m(<span class=hljs-number >1</span>) + b% m(<span class=hljs-number >2</span>)) * b% separation)
<span class=hljs-keyword >end</span> <span class=hljs-function ><span class=hljs-keyword >subroutine</span></span> my_jdot_ml</code></pre>
<p></div>
<h2 id=extra_work ><a href="#extra_work" class=header-anchor >Extra work</a></h2>
<p>All done already&#33; Then pat yourself in the back and try out the following. While implementing a boosted angular momentum loss we have just used a constant factor. A more physical approach would be to use the actual specific angular momentum of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. To do this we need to determine the distance from the center of mass to the second Lagrangian point. The dimensionless roche potential of a system with masses <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#40;from which we define the mass ratio <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><msub><mi>M</mi><mn>2</mn></msub><mi mathvariant=normal >/</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q=M_2/M_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#41; is given by</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi mathvariant=normal >Φ</mi><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>r</mi></mfrac><mo>−</mo><mi>q</mi><mrow><mo fence=true >(</mo><mfrac><mn>1</mn><msup><mi>r</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup></mfrac><mo>−</mo><mi>x</mi><mo fence=true >)</mo></mrow><mo>−</mo><mfrac><mrow><mn>1</mn><mo>+</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo stretchy=false >(</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\Phi=-\frac{1}{r} - q\left(\frac{1}{r&#x27;}-x\right)-\frac{1+q}{2}(x^2+y^2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class=mord >Φ</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:2.0074em;vertical-align:-0.686em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.1667em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.6779em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:2.0074em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3214em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >2</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span></span><span class=base ><span class=strut  style="height:1.1141em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mclose >)</span></span></span></span></span>
<p>with</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>r</mi><mo>=</mo><msqrt><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></msqrt><mo separator=true >,</mo><mspace width=1em /><msup><mi>r</mi><mo mathvariant=normal  lspace=0em  rspace=0em >′</mo></msup><mo>=</mo><msqrt><mrow><mo stretchy=false >(</mo><mn>1</mn><mo>−</mo><mi>x</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><msup><mi>z</mi><mn>2</mn></msup></mrow></msqrt><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex">r = \sqrt{x^2+y^2+z^2}, \quad r&#x27; = \sqrt{(1-x)^2+y^2+z^2}.</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.24em;vertical-align:-0.2333em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.0067em;"><span class=svg-align  style="top:-3.2em;"><span class=pstrut  style="height:3.2em;"></span><span class=mord  style="padding-left:1em;"><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.9667em;"><span class=pstrut  style="height:3.2em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2333em;"><span></span></span></span></span></span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.1667em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:1.24em;vertical-align:-0.2561em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9839em;"><span class=svg-align  style="top:-3.2em;"><span class=pstrut  style="height:3.2em;"></span><span class=mord  style="padding-left:1em;"><span class=mopen >(</span><span class=mord >1</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222em;"></span><span class="mord mathnormal">x</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.9439em;"><span class=pstrut  style="height:3.2em;"></span><span class=hide-tail  style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.2561em;"><span></span></span></span></span></span><span class=mord >.</span></span></span></span></span>
<p>The coordinates <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> here are within the orbital plane &#40;see Figure above&#41;, while <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span> is the coordinate perpendicular to the orbital plane. The potential is normalized by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><msub><mi>M</mi><mn>1</mn></msub><mi mathvariant=normal >/</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">GM_1/a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class="mord mathnormal">a</span></span></span></span> and distances are normalized by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>. The figure below shows the Roche potential for a mass ratio <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">q=0.5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0.5</span></span></span></span> along the line joining both stars.</p>


<figure style="text-align:center;">
<img src="/mesa2022_hmxb/assets/minilab2/code/output/roche_1d.svg" style="padding:0; width:100%;border: 1px solid gray;" alt=" Roche potential along the line joining two stars in a binary system with $M_1/M_2=0.5$. The three peaks in the potential correspond to the Lagrangian points $L_1$, $L_2$ and $L_3$ in order of increasing $\Phi$."/>
<figcaption> Roche potential along the line joining two stars in a binary system with <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mi mathvariant=normal >/</mi><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">M_1/M_2=0.5</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2778em;"></span></span><span class=base ><span class=strut  style="height:0.6444em;"></span><span class=mord >0.5</span></span></span></span>. The three peaks in the potential correspond to the Lagrangian points <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">L_3</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in order of increasing <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >Φ</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6833em;"></span><span class=mord >Φ</span></span></span></span>.</figcaption>
</figure>

<p>From this, how would you proceed to compute the distance between <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and the center of mass of the binary system? Fully implementing this in your <code>run_binary_extras</code> can be a heavy task, so don&#39;t worry if you can&#39;t manage to finish it. Most relevant part is that you understand how this could be implemented.</p>
<h2 id=answers ><a href="#answers" class=header-anchor >Answers</a></h2>
<p>Below there is a set of answers to the questions given. <strong> <span style="color:red"> Be sure to try and answer them by yourself before peeking in here!</span></strong></p>
<button type=button  class=collapsible >  Answers to questions, <strong>press to expand  <span style="color:red"> (Spoilers!!)</span></strong> </button><div class=collapsiblecontent >  TBD </div>
<h2 id=references ><a href="#references" class=header-anchor >References</a></h2>
<ul>
<li><p><a id=miller-jones21  class=anchor ></a> <a href="https://ui.adsabs.harvard.edu/abs/2021Sci...371.1046M/abstract">Miller-Jones, James C. A., et al.</a>, Science, Volume 371, Issue 6533, pp. 1046-1049 &#40;2021&#41;</p>

<li><p><a id=orosz07  class=anchor ></a> <a href="https://ui.adsabs.harvard.edu/abs/2007Natur.449..872O/abstract">Orosz, Jerome A., et al.</a>, Nature, Volume 449, Issue 7164, pp. 872-875 &#40;2007&#41;</p>

<li><p><a id=orosz09  class=anchor ></a> <a href="https://ui.adsabs.harvard.edu/abs/2009ApJ...697..573O/abstract">Orosz, Jerome A., et al.</a>, The Astrophysical Journal, Volume 697, Issue 1, pp. 573-591 &#40;2009&#41;</p>

<li><p><a id=lu22  class=anchor ></a> <a href="https://ui.adsabs.harvard.edu/abs/2022arXiv220400847L/abstract">Lu, Wenbin ; Fuller, Jim ; Quataert, Eliot ; Bonnerot, Clément</a>, eprint arXiv:2204.00847</p>

</ul>
<div class=page-foot >
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Pablo Marchant. Last modified: August 09, 2022.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
<script>
    var coll = document.getElementsByClassName("collapsible");
    var i;
  
    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function() {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.display === "block") {
          content.style.display = "none";
        } else {
          content.style.display = "block";
        }
      });
    }
  </script></div>
    </div>